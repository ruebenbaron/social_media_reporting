<!DOCTYPE html>
<html>
  <head>
    <title>Reporting Oktober 2016</title>
  </head>
  <body>
    <script>
      
      
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '339440106419025',
          xfbml      : true,
          version    : 'v2.8'
        });
        var wettbewerber = ["mercedesbenzbank","ingdiba", "targobank", "comdirect", "fidorbank", "deutsche.kreditbank", "consorbank", "commerzbank", "deutschebank", "ally", "barclaysUK"];
        var access_token = "EAACEdEose0cBAIIKoQUE72xCLE77ZBehGoC5K5ZAF6qq806dbRfgUDitMbfX6ZClZCGgd6Klid8cw1dIxbwgOqqj7ZAB5MzbfGmjI1ZCPfJzmWiDK5nZA5eWpK0HR2BQVBn3rEH6MsUNqGqZCIBXy3aMQy2ZB3ZBdlUSkTsR9utIq1HgZDZD"

        function getFanCount(page_name) {
          FB.api(
            '/' + page_name,
            'GET',
            {"fields":"fan_count", "access_token":access_token},
            function(response) {
              var text = JSON.stringify(response);
              var obj = JSON.parse(text);
              return obj.fan_count;
            }
          );
        }

        function getPostCount(page_name) {
          FB.api(
            '/' + page_name + '/posts',
            'GET',
            {"fields":"message,likes.limit(0).summary(1)","since":"2016-09-01","until":"2016-10-01","access_token":access_token},
            function(response) {
              var text = JSON.stringify(response);
              var obj = JSON.parse(text);
              return obj.data.length;
            }
          );
        }

        function appendFanCount(page_name) {
          var div = document.getElementById(page_name);
          var para = document.createElement("p");
          var fan_count = getFanCount(page_name);
          fan_count = fan_count.toString();
          var node = document.createTextNode("Fan Count: " + fan_count);
          para.appendChild(node);
          div.appendChild(para);
        }

        function appendPostCount(page_name) {
          var div = document.getElementById(page_name);
          var para = document.createElement("p");
          var post_count = getPostCount(page_name);
          post_count = post_count.toString();
          var node = document.createTextNode("Post Count last month: " + post_count);
          para.appendChild(node);
          div.appendChild(para);
        }

        function createPageDiv(page_name) {
          var divResults = document.getElementById("results");
          var div = document.createElement("div");
          div.id = page_name;
          divResults.appendChild(div);
        }
        console.log(getFanCount("mercedesbenzbank"));
        console.log(getPostCount("mercedesbenzbank"));
        createPageDiv(wettbewerber[0]);
        appendFanCount(wettbewerber[0]);
        appendPostCount(wettbewerber[0]);
        
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "//connect.facebook.net/en_US/sdk.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    </script>


    <div id="results">
      
    </div>
  </body>
</html>
